<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DreamWeavers ✨ — Create Your Own Magical Story</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Luckiest+Guy&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- External libs: confetti + jsPDF -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js" defer></script>
    <!-- REMOVED: tsParticles -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
    <script src="app.js" defer></script>
</head>
<!-- Body will have data-theme and data-font-size -->
<body>
    <!-- NEW: Stardust Cursor -->
    <div id="stardust-trail"></div>
    
    <!-- NEW: Animated Bubbles Background -->
    <div class="bubbles-bg">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>
    
    <header class="header">
        <h1 class="header-title">DreamWeavers ✨</h1>
        <p class="header-subtitle">Create Your Own Magical Story</p>
        <button id="themeToggle" class="theme-toggle" title="Change Magic Theme">
            <span>☀️</span>
        </button>
    </header>

    <main class="main-container">
        <section class="hero-section">
            <div class="parallax-layer-hero" id="parallax-1"></div>
            <div class="parallax-layer-hero" id="parallax-2"></div>
            <h2 class="hero-title">Let Your Imagination Soar</h2>
            <p class="hero-description">Enter your name, choose a magical world, and watch your story come to life!</p>
            <!-- UPDATED: Added data-tilt for 3D effect -->
            <button class="btn-primary" id="heroCreate" data-tilt>✨ Create a Story</button>
            <button class="btn-secondary" id="heroExplore" data-tilt>📚 View My Stories</button>
        </section>

        <section class="form-section card">
            <form id="storyForm" class="story-form">
                
                <div class="field">
                    <label for="userName"><span class="step-bubble">1</span> Your Name</label>
                    <input type="text" id="userName" name="userName" placeholder="e.g., Lily or Tom" required>
                </div>

                <div class="field">
                    <label><span class="step-bubble">2</span> Choose a Magical World</label>
                    <div class="choice-grid" id="world-grid">
                        <div class="choice-option">
                            <input type="radio" id="world_forest" name="userWorld" value="Enchanted Forest" checked>
                            <label for="world_forest">
                                <span class="emoji">🌳</span>
                                <span class="text">Enchanted Forest</span>
                            </label>
                        </div>
                        <div class="choice-option">
                            <input type="radio" id="world_castle" name="userWorld" value="Mystical Castle">
                            <label for="world_castle">
                                <span class="emoji">🏰</span>
                                <span class="text">Mystical Castle</span>
                            </label>
                        </div>
                        <div class="choice-option">
                            <input type="radio" id="world_ocean" name="userWorld" value="Underwater Kingdom">
                            <label for="world_ocean">
                                <span class="emoji">🐠</span>
                                <span class="text">Underwater World</span>
                            </label>
                        </div>
                        <div class="choice-option">
                            <input type="radio" id="world_sky" name="userWorld" value="Floating Sky Islands">
                            <label for="world_sky">
                                <span class="emoji">☁️</span>
                                <span class="text">Sky Islands</span>
                            </label>
                        </div>
                        <div class="choice-option">
                            <input type="radio" id="world_custom" name="userWorld" value="custom">
                            <label for="world_custom">
                                <span class="emoji">✏️</span>
                                <span class="text">Custom...</span>
                            </label>
                        </div>
                    </div>
                    <input type="text" id="customWorld" name="customWorld" placeholder="Enter your own magical world" class="hidden custom-input">
                </div>

                <div class="field">
                    <label><span class="step-bubble">3</span> Pick a Story Mood</label>
                    <div class="choice-grid" id="mood-grid">
                        <div class="choice-option">
                            <input type="radio" id="mood_adventure" name="userMood" value="adventure" checked>
                            <label for="mood_adventure">
                                <span class="emoji">🚀</span>
                                <span class="text">Adventure</span>
                            </label>
                        </div>
                        <div class="choice-option">
                            <input type="radio" id="mood_whimsical" name="userMood" value="whimsical">
                            <label for="mood_whimsical">
                                <span class="emoji">🎨</span>
                                <span class="text">Whimsical</span>
                            </label>
                        </div>
                         <div class="choice-option">
                            <input type="radio" id="mood_funny" name="userMood" value="funny">
                            <label for="mood_funny">
                                <span class="emoji">😂</span>
                                <span class="text">Funny</span>
                            </label>
                        </div>
                        <div class="choice-option">
                            <input type="radio" id="mood_mystery" name="userMood" value="mystery">
                            <label for="mood_mystery">
                                <span class="emoji">🕵️</span>
                                <span class="text">Mystery</span>
                            </label>
                        </div>
                        <div class="choice-option">
                            <input type="radio" id="mood_custom" name="userMood" value="custom">
                            <label for="mood_custom">
                                <span class="emoji">✏️</span>
                                <span class="text">Custom...</span>
                            </label>
                        </div>
                    </div>
                    <input type="text" id="customMood" name="customMood" placeholder="Enter your own story mood" class="hidden custom-input">
                </div>

                <button type="submit" class="btn-primary btn-submit">✨ Create My Magical Story</button>
            </form>
        </section>
    </main>

    <div class="story-container">
        <section id="storyDisplay" class="story-display hidden card">
            <div class="story-header">
                <h2 id="storyTitle" class="story-title"></h2>
                
                <div class="story-image-wrapper">
                    <img id="storyImage" src="" alt="Generated story illustration" class="story-image hidden" />
                </div>
                <button id="generateImageBtn" class="btn-secondary">🎨 Re-Generate Image</button>
            </div>
            
            <div class="story-actions">
                <button id="readAloudBtn" title="Read Aloud" class="btn-icon">🔊</button>
                <button id="favoriteBtn" title="Favorite" class="btn-icon">⭐</button>
                <button id="fontToggleBtn" title="Change Font Size" class="btn-icon btn-font-toggle">A</button>
                <button id="shareStoryBtn" title="Share" class="btn-icon">📤</button>
                <button id="saveStoryBtn" title="Download PDF" class="btn-icon download-pdf">📄</button>
            </div>
            
            <hr class="magic-divider">

            <div id="storyStats" class="story-stats">
                <!-- Skeleton loader will go here first -->
            </div>

            <hr class="magic-divider">

            <div class="story-content">
                <div id="storyBody">
                    <!-- Typewriter effect will populate this -->
                </div>
                <div class="moral"></div>
            </div>
            
            <hr class="magic-divider">

            <div class="story-footer">
                <button id="regenerateBtn" class="btn-secondary">🔄 Re-Create Story</button>
                <button id="newStoryBtn" class="btn-primary">✨ Create New Story</button>
            </div>
        </section>
    </div>

    <footer class="footer">
        <p>© 2025 DreamWeavers. Made with ✨</p>
    </footer>

    <!-- Modals -->
    <div id="pastModal" class="modal">
        <div class="modal-card">
            <div class="modal-header">
                <h3>My Past Stories</h3>
                <button id="closePastBtn" class="btn-icon close-modal" title="Close">X</button>
            </div>
            <div id="pastContent" class="modal-body"></div>
        </div>
    </div>
    
    <div id="shareModal" class="modal">
         <div class="modal-card">
            <div class="modal-header">
                <h3>Share Your Story</h3>
                <button class="btn-icon close-modal" title="Close">X</button>
            </div>
            <div class="modal-body share-options">
                <button class="share-btn copy-link" data-platform="copy">📋 Copy Story Text</button>
                <button class="share-btn" data-platform="whatsapp">💬 Share on WhatsApp</button>
                <button class="share-btn" data-platform="linkedin">🔗 Share on LinkedIn</button>
                <button class="share-btn" data-platform="twitter">🐦 Share on X (Twitter)</button>
                <button class="share-btn" data-platform="email">✉️ Share via Email</button>
                <button class="share-btn" data-platform="facebook">f Share on Facebook</button>
                <button class="download-pdf">📄 Download as PDF</button>
            </div>
        </div>
    </div>
    
    <div id="dictionaryModal" class="modal">
         <div class="modal-card modal-dictionary">
            <div class="modal-header">
                <h3 id="dictionaryWord"></h3>
                <button class="btn-icon close-modal" title="Close">X</button>
            </div>
            <div class="modal-body">
                <p id="dictionaryDefinition"></p>
            </div>
        </div>
    </div>
    
    <div id="onboard" class="modal hidden onboard">
        <div class="modal-card">
            <div class="modal-welcome-graphic">✨</div>
            <div class="modal-header">
                <h3>Welcome to DreamWeavers!</h3>
            </div>
            <div class="modal-body">
                <p>Let's create a magical story just for you in 3 simple steps!</p>
                <ul>
                    <li><strong>1. Enter your name</strong> (the story's hero!)</li>
                    <li><strong>2. Pick a magical world</strong> and a mood.</li>
                    <li><strong>3. Hit "Create"</strong> and watch your story appear!</li>
                </ul>
                <p>You can read, save, and share all your creations. Let's begin!</p>
            </div>
            <div class="modal-footer">
                <button id="gotItBtn" class="btn-primary">Let's Go! ✨</button>
            </div>
        </div>
    </div>
</body>
</html>

